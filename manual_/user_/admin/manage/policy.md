# 정책 관리

> 정책 관리는 클러스터 내에서 리소스 생성이나 사용에 대한 규칙을 설정하는 메뉴입니다. 
> 
> 운영자 권한을 가진 사용자가 접근할 수 있습니다.
> 
> 이 메뉴를 통해 보안, 리소스 제한, 네이밍 규칙 등 다양한 운영 정책을 직접 만들고 적용할 수 있습니다.
>
>적용된 정책은 Kyverno를 통해 자동으로 감시되고, 클러스터에 일관된 규칙이 유지되도록 도와줍니다.


## 목차

1. [정책 정보 조회](#1-정책-정보-조회)
   - 1.1. [리스트 조회](#11-리스트-조회)
   - 1.2. [상세정보 조회](#12-상세정보-조회)
   - 1.3. [정책 적용 여부 조회](#13-정책-적용-여부-조회)
   - 1.4. [이벤트 조회](#14-이벤트-조회)
   - 1.5. [로그 조회](#15-로그-조회)
2. [정책 생성](#2-정책-생성)
3. [정책 수정](#3-정책-수정)
4. [정책 삭제](#4-정책-삭제)
5. [정책 적용](#5-정책-적용)
6. [정책 적용 해제](#6-정책-적용-해제)

---
## 1. 정책 정보 조회
### 1.1. 리스트 조회
* 적용할 수 있는 정책의 목록이 노출됩니다.
* 정책 이름, 카테고리, 이벤트 누적 발생수 ,정책 등록자, 정책 등록일을 확인할 수 있습니다.

![img.png](img/policy_list.png)

### 1.2. 상세정보 조회
* 리스트에서 특정 정책을 선택하면 하단 상세정보 탭에 정책의 상세 정보가 조회됩니다.
* 선택된 정책의 설명, 카테고리, 이벤트 누적 발생수, 정책 등록자, 정책 등록일 등을 확인할 수 있습니다.

![img.png](img/policy_list_selected.png)
![img.png](img/policy_detail.png)

### 1.3. 정책 적용 여부 조회
* 클러스터별로 해당 정책이 적용 되었는지 확인할 수 있습니다.
* 클러스터명, 적용여보, 클러스터 사용목적, 클러스터 버전을 확인합니다.

![img.png](img/policy_applied.png)

### 1.4. 이벤트 조회
* 해당 정책으로 인해 발생한 전체 이벤트 수를 집계합니다.
* 일주일 단위, 한달 단위로 그래프를 확인할 수 있습니다.

![img.png](img/policy_event.png)

### 1.5. 로그 조회
* 해당 정책으로 인해 발생한 이벤트의 로그를 조회할 수 있습니다.
* 이벤트 발생시간, Type(PolicyReport, ClusterPolicyReport), Result(skip, pass, fail, warn, error), Log를 확인합니다.

![img.png](img/policy_log.png)

---
## 2. 정책 생성
1. 목록 위 '생성' 버튼을 클릭합니다.

![img.png](img/policy_create.png)

2. 정책을 생성할 수 있는 폼이 노출됩니다.

![img.png](img/policy_create_form.png)

3. 적용할 정책의 스펙을 입력합니다. 
- 정책 이름은 중복될 수 없기에 입력 후 '검색' 버튼을 클릭하여 중복 확인을 합니다.
- 구분은 해당 정책의 목적을 의미합니다. 구분의 종류에는 보안, 자원관리, 규정준수, 감사 및 로깅이 있습니다.
- 설명 란에는 해당 정책이 어떤 규칙을 정의하고 있는지 기입합니다.
- 스펙 입력이 완료되면 하단의 '생성' 버튼을 클릭합니다.

![img_1.png](img/policy_create_yaml.png)

4. 정책이 정상적으로 등록된 것을 확인합니다.

![img.png](img/policy_create_result.png)

---
## 3. 정책 수정
1. 수정하고자 하는 정책을 선택하고 목록 위 '수정' 버튼을 클릭합니다.

![img.png](img/policy_update.png)

2. 정책을 수정할 수 있는 폼이 노출됩니다.

![img_1.png](img/policy_update_form.png)

3. 스펙을 수정한 후 하단의 '수정' 버튼을 클릭합니다.

![img.png](img/policy_update_yaml.png)

4. 목록 또는 하단의 상세정보 탭에서 수정이 정상적으로 완료된 것을 확인합니다.

![img.png](img/policy_update_result.png)

---
## 4. 정책 삭제
1. 삭제하고자 하는 정책을 선택하고 목록 위 '삭제' 버튼을 클리합니다.

![img.png](img/policy_delete.png)

2. 삭제를 확인하는 알림창이 노출되면 '확인' 버튼을 클릭합니다.

![img.png](img/policy_delete_check.png)

3. 목록에서 정책이 삭제된 것을 확인합니다.

![img.png](img/policy_delete_result.png)

---
## 5. 정책 적용
1. 적용하고자 하는 정책을 선택하고 하단의 '정책' 탭을 클릭합니다.

![img.png](img/policy_apply.png)

2. 적용할 클러스터를 선택하고 '적용' 버튼을 클릭합니다.

![img.png](img/policy_apply_bt.png)

3. 정책이 클러스터에 적용된 것을 확인합니다.

![img.png](img/policy_apply_result.png)

--- 
## 6. 정책 적용 해제
1. 적용을 해제하고자 하는 정책을 선택하고 하단의 '정책' 탭을 클릭합니다.

![img_1.png](img/policy_disable.png)

2. 적용을 해제할 클러스터를 선택하고 '적용' 버튼을 클릭합니다.

![img.png](img/policy_disable_bt.png)

3. 정책이 클러스터에 적용 해제된 것을 확인합니다.

![img.png](img/policy_disable_result.png)